<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Immediate mode GUI (IMGUI)</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<title>andersch.dev</title>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" href="/style.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Ubuntu:regular,bold&subset=Latin"><script type="text/javascript" src="/script.js" defer></script>
</head>
<body>
<header id="top" class="status">
<header>
<h1 class="title" id="title"><a href="/">andersch.dev</a></h1>

<div class="icons">
  	<a id="icon-github" href="https://github.com/dandersch" ><span>dandersch</span><img src="/icons/github.svg"></a>
  	<a id="icon-feed"   href="https://andersch.dev/feed.xml" target="_blank"><img src="/icons/rss.svg"><span></span></a>
  	<a id="icon-mail"   href="mailto:contact [at} andersch {dot) dev"  ><img src="/icons/mail.svg"><span>contact [at} andersch {dot) dev</span></a>
</div>
<div>
	<nav class="nav">
		<a class="nav-link" href="/article">article</a>
		<a class="nav-link" href="/project">project</a>
		<a class="nav-link" href="/other">other</a>
		<a class="nav-link" href="/notes">wiki</a>
	</nav>
</div>
</header>
</header>
<main id="content" class="content">
<div class="tags-date-box"><div class="tags"><code>[ <a href="/tag/graphics.html">graphics</a> ]</code></div></div><h1>Immediate mode GUI (IMGUI)</h1>
<p>
An immediate mode graphic <a href="ui.html#ID-1aec063c-db9f-49f6-ba65-b1d0e7fe3bb4">user interface</a> (IMGUI) is a GUI design paradigm that
stands opposed to the more common style of retained mode GUIs.
</p>

<p>
Popular implementations of IMGUIs include:
</p>
<ul class="org-ul">
<li><a href="https://github.com/ocornut/imgui">Dear ImGui</a></li>
<li><a href="https://github.com/Immediate-Mode-UI/Nuklear">nuklear</a></li>
<li><a href="https://github.com/rxi/microui">microui</a></li>
</ul>

<p>
The term is derived from early immediate-mode <a href="rendering_api.html#ID-aaa98db5-f284-4a8a-9b0e-9e650530df6d">rendering APIs</a> such as used in
legacy <a href="opengl.html#ID-394d1edc-3e93-4914-ae21-6ffd17a6b163">OpenGL</a> (see below) - until the API switched to a retain mode pattern for
performance reasons.
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-function-name">glBegin</span>(GL_TRIANGLES);
    glColor3f(1.0f, 0.0f, 0.0f);   glVertex2f(0.0f,   1.0f);
    glColor3f(0.0f, 1.0f, 0.0f);   glVertex2f(0.87f,  -0.5f);
    glColor3f(0.0f, 0.0f, 1.0f);   glVertex2f(-0.87f, -0.5f);
<span class="org-function-name">glEnd</span>();
</pre>
</div>
<div id="outline-container-ID-92daeeb1-93c7-4dde-840d-82659f92402f" class="outline-2">
<h2 id="ID-92daeeb1-93c7-4dde-840d-82659f92402f"><a href="#ID-92daeeb1-93c7-4dde-840d-82659f92402f">RectCut - Simple UI Layouts</a></h2>
<div class="outline-text-2" id="text-RectCut%20-%20Simple%20UI%20Layouts">
<p>
<a href="https://haltaire.substack.com/p/rectcut-for-dead-simple-ui-layouts?r=3lg47x&amp;utm_campaign=post&amp;utm_medium=web&amp;triedRedirect=true">RectCut for dead simple UI layouts</a> (<a href="https://web.archive.org/web/20230331132208/https://halt.software/dead-simple-layouts/">mirror</a>)
</p>
</div>
<div id="outline-container-Simple%20API" class="outline-3">
<h3 id="Simple%20API"><a href="#Simple%20API">Simple API</a></h3>
<div class="outline-text-3" id="text-Simple%20API">
<p>
Define functions that cut a smaller rectangle of an input rectangle and return
it. They also modify the input rectangle.
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">struct</span> <span class="org-type">Rect</span> { <span class="org-type">float</span> <span class="org-variable-name">minx</span>, <span class="org-variable-name">miny</span>, <span class="org-variable-name">maxx</span>, <span class="org-variable-name">maxy</span>; };

<span class="org-type">Rect</span> <span class="org-function-name">cut_left</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>) {
    <span class="org-type">float</span> <span class="org-variable-name">minx</span> = rect-&gt;minx;
    rect-&gt;minx = min(rect-&gt;max.x, rect-&gt;minx + a);
    <span class="org-keyword">return</span> (Rect){ minx, rect-&gt;miny, rect-&gt;minx, rect-&gt;maxy };
}

<span class="org-type">Rect</span> <span class="org-function-name">cut_right</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>) {
    <span class="org-type">float</span> <span class="org-variable-name">maxx</span> = rect-&gt;maxx;
    rect-&gt;maxx = max(rect-&gt;minx, rect-&gt;maxx - a);
    <span class="org-keyword">return</span> (Rect){ rect-&gt;maxx, rect-&gt;miny, maxx, rect-&gt;maxy };
}

<span class="org-type">Rect</span> <span class="org-function-name">cut_top</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>) {
    <span class="org-type">float</span> <span class="org-variable-name">miny</span> = rect-&gt;miny;
    rect-&gt;miny = min(rect-&gt;max.y, rect-&gt;miny + a);
    <span class="org-keyword">return</span> (Rect){ rect-&gt;minx, miny, rect-&gt;maxx, rect-&gt;miny };
}

<span class="org-type">Rect</span> <span class="org-function-name">cut_bottom</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>) {
    <span class="org-type">float</span> <span class="org-variable-name">maxy</span> = rect-&gt;maxy;
    rect-&gt;maxy = max(rect-&gt;miny, rect-&gt;maxy - a);
    <span class="org-keyword">return</span> (Rect){ rect-&gt;minx, rect-&gt;maxy, rect-&gt;maxx, maxy };
}
</pre>
</div>
</div>
</div>
<div id="outline-container-Example%3A%20Toolbar" class="outline-3">
<h3 id="Example%3A%20Toolbar"><a href="#Example%3A%20Toolbar">Example: Toolbar</a></h3>
<div class="outline-text-3" id="text-Example%3A%20Toolbar">
<div class="org-src-container">
<pre class="src src-C"><span class="org-type">Rect</span> <span class="org-variable-name">layout</span> = { 0, 0, 180, 16 };

<span class="org-type">Rect</span> <span class="org-variable-name">r1</span> = cut_left(&amp;layout, 16);
<span class="org-type">Rect</span> <span class="org-variable-name">r2</span> = cut_left(&amp;layout, 16);
<span class="org-type">Rect</span> <span class="org-variable-name">r3</span> = cut_left(&amp;layout, 16);

<span class="org-type">Rect</span> <span class="org-variable-name">r4</span> = cut_right(&amp;layout, 16);
<span class="org-type">Rect</span> <span class="org-variable-name">r5</span> = cut_right(&amp;layout, 16);
</pre>
</div>
</div>
</div>
<div id="outline-container-Example%3A%20Two%20panel%20application" class="outline-3">
<h3 id="Example%3A%20Two%20panel%20application"><a href="#Example%3A%20Two%20panel%20application">Example: Two panel application</a></h3>
<div class="outline-text-3" id="text-Example%3A%20Two%20panel%20application">
<div class="org-src-container">
<pre class="src src-C"><span class="org-comment-delimiter">// </span><span class="org-comment">Top bar with icons and title</span>
<span class="org-type">Rect</span> <span class="org-variable-name">top</span> = cut_top(&amp;layout, 16);
    <span class="org-type">Rect</span> <span class="org-variable-name">button_close</span> = cut_right(&amp;top, 16);
    <span class="org-type">Rect</span> <span class="org-variable-name">button_maximize</span> = cut_right(&amp;top, 16);
    <span class="org-type">Rect</span> <span class="org-variable-name">button_minimize</span> = cut_right(&amp;top, 16);
    <span class="org-type">Rect</span> <span class="org-variable-name">title</span> = top;

<span class="org-comment-delimiter">// </span><span class="org-comment">Bottom bar.</span>
<span class="org-type">Rect</span> <span class="org-variable-name">bottom</span> = cut_bottom(&amp;layout, 16);

<span class="org-comment-delimiter">// </span><span class="org-comment">Left and right panels.</span>
<span class="org-type">Rect</span> <span class="org-variable-name">panel_left</span> = cut_left(&amp;layout, w / 2);
<span class="org-type">Rect</span> <span class="org-variable-name">panel_right</span> = layout;
</pre>
</div>
</div>
</div>
<div id="outline-container-Example%3A%20Button%20sized%20by%20its%20label" class="outline-3">
<h3 id="Example%3A%20Button%20sized%20by%20its%20label"><a href="#Example%3A%20Button%20sized%20by%20its%20label">Example: Button sized by its label</a></h3>
<div class="outline-text-3" id="text-Example%3A%20Button%20sized%20by%20its%20label">
<ul class="org-ul">
<li>If needed, first calculate the size and then cut.</li>
<li>E.g., a button that sizes by the label</li>
<li>This demonstrates building widgets using this method</li>
<li>However, no way of specifying <code>cut_left</code>, <code>cut_right</code>, etc.</li>
</ul>

<div class="org-src-container">
<pre class="src src-C"><span class="org-type">bool</span> <span class="org-function-name">button</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">layout</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">label</span>) {
    <span class="org-type">float</span> <span class="org-variable-name">size</span> = measure_text(label);
    <span class="org-type">Rect</span> <span class="org-variable-name">rect</span> = cut_left(layout, size);
    <span class="org-comment-delimiter">/* </span><span class="org-comment">interaction with button</span><span class="org-comment-delimiter"> */</span>
    <span class="org-comment-delimiter">/* </span><span class="org-comment">draw the button</span><span class="org-comment-delimiter"> */</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-Extended%20API" class="outline-3">
<h3 id="Extended%20API"><a href="#Extended%20API">Extended API</a></h3>
<div class="outline-text-3" id="text-Extended%20API">
<p>
To enable control of the cut side from the caller for widgets, specify the side
inside a new <code>RectCut</code> struct.
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">enum</span> <span class="org-type">RectCutSide</span> {
    <span class="org-variable-name">RectCut_Left</span>,
    <span class="org-variable-name">RectCut_Right</span>,
    <span class="org-variable-name">RectCut_Top</span>,
    <span class="org-variable-name">RectCut_Bottom</span>,
};

<span class="org-keyword">struct</span> <span class="org-type">RectCut</span> { <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>; <span class="org-type">RectCutSide</span> <span class="org-variable-name">side</span>; };
<span class="org-type">RectCut</span> <span class="org-function-name">rectcut</span>(<span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">RectCutSide</span> <span class="org-variable-name">side</span>) { <span class="org-keyword">return</span> (RectCut) { .rect = rect, .side = side }; } <span class="org-comment-delimiter">/* </span><span class="org-comment">constructor</span><span class="org-comment-delimiter"> */</span>

<span class="org-type">Rect</span> <span class="org-function-name">rectcut_cut</span>(<span class="org-type">RectCut</span> <span class="org-variable-name">rectcut</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>) {
    <span class="org-keyword">switch</span> (rectcut.side)
    {
        <span class="org-keyword">case</span> RectCut_Left:   <span class="org-keyword">return</span> cut_left(rectcut-&gt;rect,   a);
        <span class="org-keyword">case</span> RectCut_Right:  <span class="org-keyword">return</span> cut_right(rectcut-&gt;rect,  a);
        <span class="org-keyword">case</span> RectCut_Top:    <span class="org-keyword">return</span> cut_top(rectcut-&gt;rect,    a);
        <span class="org-keyword">case</span> RectCut_Bottom: <span class="org-keyword">return</span> cut_bottom(rectcut-&gt;rect, a);
        <span class="org-keyword">default</span>: abort();
    }
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Same as cut, except they keep the input rect intact.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Useful for decorations (9-patch-much?).</span>
<span class="org-type">Rect</span> <span class="org-function-name">get_left</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">get_right</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">get_top</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">get_bottom</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);

<span class="org-comment-delimiter">// </span><span class="org-comment">These will add a rectangle outside of the input rectangle.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Useful for tooltips and other overlay elements.</span>
<span class="org-type">Rect</span> <span class="org-function-name">add_left</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">add_right</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">add_top</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);
<span class="org-type">Rect</span> <span class="org-function-name">add_bottom</span>(<span class="org-keyword">const</span> <span class="org-type">Rect</span>* <span class="org-variable-name">rect</span>, <span class="org-type">float</span> <span class="org-variable-name">a</span>);

<span class="org-comment-delimiter">/* </span><span class="org-comment">Further you can implement extend and contract functions for Rect that are useful for borders and overhangs.</span><span class="org-comment-delimiter"> */</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-UI%20Code" class="outline-2">
<h2 id="UI%20Code"><a href="#UI%20Code">UI Code</a></h2>
<div class="outline-text-2" id="text-UI%20Code">
</div>
<div id="outline-container-Widgets%20API" class="outline-3">
<h3 id="Widgets%20API"><a href="#Widgets%20API">Widgets API</a></h3>
<div class="outline-text-3" id="text-Widgets%20API">
<div class="org-src-container">
<pre class="src src-C"><span class="org-comment-delimiter">/* </span><span class="org-comment">basic widgets</span><span class="org-comment-delimiter"> */</span>
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Label</span>(<span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Image</span>(<span class="org-type">R_Slice2F32</span> <span class="org-variable-name">slice</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">void</span>      <span class="org-function-name">UI_Spacer</span>(<span class="org-type">UI_Size</span> <span class="org-variable-name">size</span>);
<span class="org-preprocessor">#define</span>   <span class="org-function-name">UI_Padding</span>(<span class="org-variable-name">size</span>) DeferLoop(UI_Spacer(size), UI_Spacer(size))
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Button</span>(<span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Check</span>(<span class="org-type">B32</span> <span class="org-variable-name">checked</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Radio</span>(<span class="org-type">B32</span> <span class="org-variable-name">selected</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_Expander</span>(<span class="org-type">B32</span> <span class="org-variable-name">expanded</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_SliderF32</span>(<span class="org-type">F32</span> *<span class="org-variable-name">value</span>, <span class="org-type">Rng1F32</span> <span class="org-variable-name">range</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_LineEdit</span>(<span class="org-type">TxtPt</span> *<span class="org-variable-name">cursor</span>, <span class="org-type">TxtPt</span> *<span class="org-variable-name">mark</span>, <span class="org-type">U64</span> <span class="org-variable-name">buffer_size</span>, <span class="org-type">U8</span> *<span class="org-variable-name">buffer</span>, <span class="org-type">U64</span> *<span class="org-variable-name">string_size</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">void</span>      <span class="org-function-name">UI_ColorPickerTooltipInfo</span>(<span class="org-type">Vec3F32</span> <span class="org-variable-name">hsv</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_SatValPicker</span>(<span class="org-type">F32</span> <span class="org-variable-name">hue</span>, <span class="org-type">F32</span> *<span class="org-variable-name">out_sat</span>, <span class="org-type">F32</span> *<span class="org-variable-name">out_val</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">UI_Signal</span> <span class="org-function-name">UI_HuePicker</span>(<span class="org-type">F32</span> *<span class="org-variable-name">out_hue</span>, <span class="org-type">F32</span> <span class="org-variable-name">sat</span>, <span class="org-type">F32</span> <span class="org-variable-name">val</span>, <span class="org-type">String8</span> <span class="org-variable-name">string</span>);

<span class="org-comment-delimiter">/* </span><span class="org-comment">layout parents</span><span class="org-comment-delimiter"> */</span>
<span class="org-type">void</span>    <span class="org-function-name">UI_NamedColumnBegin</span>(<span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">void</span>    <span class="org-function-name">UI_ColumnBegin</span>();
<span class="org-type">void</span>    <span class="org-function-name">UI_ColumnEnd</span>();
<span class="org-preprocessor">#define</span> <span class="org-function-name">UI_NamedColumn</span>(<span class="org-variable-name">s</span>) DeferLoop(UI_NamedColumnBegin(s), UI_ColumnEnd())
<span class="org-preprocessor">#define</span> <span class="org-function-name">UI_NamedColumnF</span>(...) DeferLoop(UI_NamedColumnBeginF(__VA_ARGS__), UI_ColumnEnd())
<span class="org-preprocessor">#define</span> <span class="org-variable-name">UI_Column</span> DeferLoop(UI_ColumnBegin(), UI_ColumnEnd())

<span class="org-type">void</span>    <span class="org-function-name">UI_NamedRowBegin</span>(<span class="org-type">String8</span> <span class="org-variable-name">string</span>);
<span class="org-type">void</span>    <span class="org-function-name">UI_RowBegin</span>();
<span class="org-type">void</span>    <span class="org-function-name">UI_RowEnd</span>();
<span class="org-preprocessor">#define</span> <span class="org-function-name">UI_NamedRow</span>(<span class="org-variable-name">s</span>) DeferLoop(UI_NamedRowBegin(s), UI_RowEnd())
<span class="org-preprocessor">#define</span> <span class="org-function-name">UI_NamedRowF</span>(...) DeferLoop(UI_NamedRowBeginF(__VA_ARGS__), UI_RowEnd())
<span class="org-preprocessor">#define</span> <span class="org-variable-name">UI_Row</span> DeferLoop(UI_RowBegin(), UI_RowEnd())
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-UI%20Separation" class="outline-2">
<h2 id="UI%20Separation"><a href="#UI%20Separation">UI Separation</a></h2>
<div class="outline-text-2" id="text-UI%20Separation">
<p>
UI separation into two main parts:
</p>
<ul class="org-ul">
<li><b>Core</b>: implements common codepaths and helpers</li>
<li><b>Builder</b>: uses the core and arranges widgets to produce interfaces</li>
<li>However, the core also provides builder code for implementing specialized
widgets using <i>"escape hatches".</i></li>
</ul>
</div>
</div>
<div id="outline-container-Build%20It%20Every%20Frame%20%28Immediate%20Mode%29" class="outline-2">
<h2 id="Build%20It%20Every%20Frame%20%28Immediate%20Mode%29"><a href="#Build%20It%20Every%20Frame%20%28Immediate%20Mode%29">Build It Every Frame (Immediate Mode)</a></h2>
<div class="outline-text-2" id="text-Build%20It%20Every%20Frame%20%28Immediate%20Mode%29">
</div>
<div id="outline-container-Widget%20Hierarchy" class="outline-3">
<h3 id="Widget%20Hierarchy"><a href="#Widget%20Hierarchy">Widget Hierarchy</a></h3>
<div class="outline-text-3" id="text-Widget%20Hierarchy">
<p>
In an IMGUI, the widget hierarchy is constructed every frame (instead of coming
from state that must be managed).
</p>

<div class="org-src-container">
<pre class="src src-C">UI_Slider(&amp;my_float, 0.0f, 100.0f, <span class="org-string">"My Float"</span>);
UI_Checkbox(&amp;my_bool, <span class="org-string">"My Bool"</span>);
UI_Radio(&amp;radio, 0, <span class="org-string">"Radio 0"</span>);
UI_Radio(&amp;radio, 1, <span class="org-string">"Radio 1"</span>);
UI_Radio(&amp;radio, 2, <span class="org-string">"Radio 2"</span>);
UI_ColorPicker(&amp;color, <span class="org-string">"Color"</span>);

UI_Checkbox(&amp;show_buttons, <span class="org-string">"Show Buttons"</span>);
<span class="org-keyword">if</span> (show_buttons)
{
    UI_Button(<span class="org-string">"Foo"</span>);
    UI_Button(<span class="org-string">"Bar"</span>);
    UI_Button(<span class="org-string">"Baz"</span>);
}
</pre>
</div>

<p>
As we see, IMGUI code&#x2026;
</p>
<ul class="org-ul">
<li>shrinks and centralizes code for each widget</li>
<li>unifies and shrinks builder code</li>
<li>Building code, hierarchy modification code, and interaction response code are
all encoded in the same location</li>
</ul>
</div>
</div>
<div id="outline-container-Manual%20Layout%20management" class="outline-3">
<h3 id="Manual%20Layout%20management"><a href="#Manual%20Layout%20management">Manual Layout management</a></h3>
<div class="outline-text-3" id="text-Manual%20Layout%20management">
<ul class="org-ul">
<li>Specify coordinates and size of every widget manually</li>
<li>Adding new widgets in the middle now requires adjustments</li>
</ul>
<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">if</span>(UI_Button(0, 0, 200, 30, <span class="org-string">"Foo"</span>)) <span class="org-comment-delimiter">// </span><span class="org-comment">draw a 200 by 30 button at (0,0)</span>
{
  <span class="org-comment-delimiter">/* </span><span class="org-comment">clicked</span><span class="org-comment-delimiter"> */</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-Encapsulate%20layout%20in%20a%20structure" class="outline-3">
<h3 id="Encapsulate%20layout%20in%20a%20structure"><a href="#Encapsulate%20layout%20in%20a%20structure">Encapsulate layout in a structure</a></h3>
<div class="outline-text-3" id="text-Encapsulate%20layout%20in%20a%20structure">
<div class="org-src-container">
<pre class="src src-C"><span class="org-type">UI_Layout</span> <span class="org-variable-name">layout</span> = UI_MakeLayout(...);
<span class="org-keyword">if</span>(UI_Button(&amp;layout, <span class="org-string">"Foo"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }

<span class="org-comment-delimiter">/* </span><span class="org-comment">or</span><span class="org-comment-delimiter"> */</span>

<span class="org-type">UI_Layout</span> <span class="org-variable-name">layout</span> = UI_MakeLayout(...);
UI_SelectLayout(&amp;layout);
<span class="org-keyword">if</span>(UI_Button(<span class="org-string">"Foo"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }
</pre>
</div>

<p>
However: No possibility of establishing a nested hierarchy of layouts (with a
root layout at the top)
</p>
</div>
</div>
<div id="outline-container-Pushing%20Layouts%20on%20to%20a%20Stack" class="outline-3">
<h3 id="Pushing%20Layouts%20on%20to%20a%20Stack"><a href="#Pushing%20Layouts%20on%20to%20a%20Stack">Pushing Layouts on to a Stack</a></h3>
<div class="outline-text-3" id="text-Pushing%20Layouts%20on%20to%20a%20Stack">
<p>
A stack can be used to return to a parent layout after building a subtree of
widgets.
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-type">UI_Layout</span> <span class="org-variable-name">layout</span> = UI_MakeLayout(...);
UI_PushLayout(&amp;layout);
<span class="org-keyword">if</span>(UI_Button(<span class="org-string">"Foo"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }
<span class="org-keyword">if</span>(UI_Button(<span class="org-string">"Bar"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }
<span class="org-function-name">UI_PopLayout</span>();
</pre>
</div>

<p>
The hierarchy is not just of layouts:
</p>
<ul class="org-ul">
<li>A window in our UI may need to have a clipping rectangle for any widgets that are "inside" it</li>
<li>We may want some subtree in the hierarchy to be scrolled by a scrollbar.</li>
<li>We may want to apply certain widget-like behavior to the entirety of a layout
(e.g., if a user clicks the background of a window, select the window)</li>
</ul>
</div>
</div>
<div id="outline-container-General%20Widget%20Hierarchy" class="outline-3">
<h3 id="General%20Widget%20Hierarchy"><a href="#General%20Widget%20Hierarchy">General Widget Hierarchy</a></h3>
<div class="outline-text-3" id="text-General%20Widget%20Hierarchy">
<p>
Reframe hierarchy to being of widgets (a parent of widgets is not different from
a button widget).
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-type">UI_Widget</span> *<span class="org-variable-name">parent</span> = ...;
<span class="org-function-name">UI_PushParent</span>(parent);
<span class="org-keyword">if</span>(UI_Button(<span class="org-string">"Foo"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }
<span class="org-keyword">if</span>(UI_Button(<span class="org-string">"Bar"</span>)) { <span class="org-comment-delimiter">/* </span><span class="org-comment">...</span><span class="org-comment-delimiter"> */</span> }
<span class="org-function-name">UI_PopParent</span>(parent);
</pre>
</div>

<ul class="org-ul">
<li>You only have a partial widget hierarchy at the time that a button
construction happens.</li>
<li>In order to use higher-level specifications, we'd need parts of the widget
tree that we don't have at that point in the frame</li>
<li>I.e., we want an offline algorithm for autolayout, but don't want to have to
specify all of the data beforehand</li>
</ul>

<p>
Rendering for the widget hierarchy is deferred in an IMGUI, since the order that
it needs to be rendered is actually the reverse of the order in which it is
specified. Widgets that consume input events first must be rendered last (on
top).
</p>

<p>
The structure of a frame, then, is this:
</p>
<ul class="org-ul">
<li>Build widget hierarchy (one pass)</li>
<li>Render (separate pass)</li>
</ul>
</div>
</div>
<div id="outline-container-Offline%20Autolayout" class="outline-3">
<h3 id="Offline%20Autolayout"><a href="#Offline%20Autolayout">Offline Autolayout</a></h3>
<div class="outline-text-3" id="text-Offline%20Autolayout">
<ul class="org-ul">
<li>We accept a single frame of delay for the rectangles that we use for consumption of events</li>
<li>We preserve no-frame-delay for the final rendering of each frame.</li>
</ul>

<p>
New frame structure:
</p>
<ul class="org-ul">
<li>Build widget hierarchy (using <b>last frame's data</b>)</li>
<li>Autolayout pass (produce fresh layout data)</li>
<li>Render (use up-to-date layout data)</li>
</ul>

<p>
Here's how semantic sizes are expressed in this algorithm:
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">enum</span> <span class="org-type">UI_SizeKind</span>
{
  <span class="org-variable-name">UI_SizeKind_Null</span>,
  <span class="org-variable-name">UI_SizeKind_Pixels</span>, <span class="org-comment-delimiter">// </span><span class="org-comment">encode a direct size in pixels</span>
  <span class="org-variable-name">UI_SizeKind_TextContent</span>, <span class="org-comment-delimiter">// </span><span class="org-comment">size is determined by, e.g., a label string</span>
  <span class="org-variable-name">UI_SizeKind_PercentOfParent</span>, <span class="org-comment-delimiter">// </span><span class="org-comment">percentage value of parent widget's size on same axis</span>
  <span class="org-variable-name">UI_SizeKind_ChildrenSum</span>, <span class="org-comment-delimiter">// </span><span class="org-comment">size on a given axis is sum of the sizes of children widgets</span>
};

<span class="org-keyword">struct</span> <span class="org-type">UI_Size</span>
{
  <span class="org-type">UI_SizeKind</span> <span class="org-variable-name">kind</span>;
  <span class="org-type">F32</span> <span class="org-variable-name">value</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">unused when kind is ChildrenSum</span>
  <span class="org-type">F32</span> <span class="org-variable-name">strictness</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">percentage of size you refuse to give up</span>
};

<span class="org-keyword">enum</span> <span class="org-type">Axis2</span>
{
  <span class="org-variable-name">Axis2_X</span>,
  <span class="org-variable-name">Axis2_Y</span>,
  <span class="org-variable-name">Axis2_COUNT</span>
};

<span class="org-keyword">struct</span> <span class="org-type">UI_Widget</span>
{
  <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
  <span class="org-type">UI_Size</span> <span class="org-variable-name">semantic_size</span>[Axis2_COUNT];

  <span class="org-comment-delimiter">// </span><span class="org-comment">recomputed every frame</span>
  <span class="org-type">F32</span> <span class="org-variable-name">computed_rel_position</span>[Axis2_COUNT]; <span class="org-comment-delimiter">// </span><span class="org-comment">pos relative to the parent pos</span>
  <span class="org-type">F32</span> <span class="org-variable-name">computed_size</span>[Axis2_COUNT]; <span class="org-comment-delimiter">// </span><span class="org-comment">size in pixels</span>
  <span class="org-type">Rng2F32</span> <span class="org-variable-name">rect</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">final on-screen rect coordinates</span>
  <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
};
</pre>
</div>

<ul class="org-ul">
<li>The input (the semantic size) and output (the computed position, size, and
final rectangle) of the autolayout algorithm are all in the same type.</li>

<li>The rect member can be used in&#x2026;
<ul class="org-ul">
<li>input event consumption on the frame following that of the autolayout pass</li>
<li>the rendering pass of the current frame.</li>
</ul></li>

<li>UI<sub>Widget</sub> doubles as a cache, and an immediate-mode data structure. On the
following frame, the UI<sub>Widget</sub> correlated from the previous frame can be used,
with its hierarchical placement (and thus the entire hierarchical structure)
being potentially reorganized. Despite the fact that these UI<sub>Widgets</sub> are
being cached as if it is a “retained-mode” data structure, the API remains
immediate-mode.</li>
</ul>
</div>
</div>
<div id="outline-container-Offline%20Autolayout%20Algorithm" class="outline-3">
<h3 id="Offline%20Autolayout%20Algorithm"><a href="#Offline%20Autolayout%20Algorithm">Offline Autolayout Algorithm</a></h3>
<div class="outline-text-3" id="text-Offline%20Autolayout%20Algorithm">
<p>
Each stage of the algorithm iterates over the widget hierarchy in a recursive,
depth-first fashion. Pay careful attention to which stages require pre-order
iterations or post-order iterations.
</p>

<p>
For each axis:
</p>
<ul class="org-ul">
<li>(Any order is acceptable) Calculate “standalone” sizes. These are sizes that
do not depend on other widgets and can be calculated purely with the
information that comes from the single widget that is having its size
calculated. (UI<sub>SizeKind</sub><sub>Pixels</sub>, UI<sub>SizeKind</sub><sub>TextContent</sub>)</li>

<li>(Pre-order) Calculate “upwards-dependent” sizes. These are sizes that strictly
depend on an ancestor’s size, other than ancestors that have
“downwards-dependent” sizes on the given axis. (UI<sub>SizeKind</sub><sub>PercentOfParent</sub>)</li>

<li>(Post-order) Calculate “downwards-dependent” sizes. These are sizes that
depend on sizes of descendants. (UI<sub>SizeKind</sub><sub>ChildrenSum</sub>)</li>

<li>(Pre-order) Solve violations. For each level in the hierarchy, this will
verify that the children do not extend past the boundaries of a given parent
(unless explicitly allowed to do so; for example, in the case of a parent that
is scrollable on the given axis), to the best of the algorithm’s ability. If
there is a violation, it will take a proportion of each child widget’s size
(on the given axis) proportional to both the size of the violation, and
(1-strictness), where strictness is that specified in the semantic size on the
child widget for the given axis.</li>

<li>(Pre-order) Finally, given the calculated sizes of each widget, compute the
relative positions of each widget (by laying out on an axis which can be
specified on any parent node). This stage can also compute the final
screen-coordinates rectangle.</li>
</ul>
</div>
</div>
<div id="outline-container-The%20Tree%20hierarchy" class="outline-3">
<h3 id="The%20Tree%20hierarchy"><a href="#The%20Tree%20hierarchy">The Tree hierarchy</a></h3>
<div class="outline-text-3" id="text-The%20Tree%20hierarchy">
<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">struct</span> <span class="org-type">UI_Widget</span>
{
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">first</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">first child</span>
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">next</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">next sibling</span>

  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">last</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">useful for appending</span>
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">prev</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">enables traversal in reverse</span>
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">parent</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">iterating upwards</span>
  <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
};

</pre>
</div>

<p>
Imagine that UI<sub>Widget</sub> is instead the type that is only used for caching
persistent data across frames. What does that look like?
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">struct</span> <span class="org-type">UI_Key</span> { ... }; <span class="org-comment-delimiter">// </span><span class="org-comment">some keying mechanism</span>

<span class="org-keyword">struct</span> <span class="org-type">UI_Widget</span>
{
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">hash_next</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">hash_prev</span>;
  <span class="org-type">UI_Key</span> <span class="org-variable-name">key</span>;
  <span class="org-type">U64</span> <span class="org-variable-name">last_frame_touched_index</span>;
  <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
};
</pre>
</div>

<p>
This is just one simple way to do it, but the basic idea is to just throw these
into a hash-table, keyed by key. At the end of every frame, if a widget’s
last<sub>frame</sub><sub>touched</sub><sub>index</sub> &lt; current<sub>frame</sub><sub>index</sub> (where, on each frame, the frame
index increments), then that widget should be “pruned”.
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">struct</span> <span class="org-type">UI_Widget</span>
{
  <span class="org-comment-delimiter">// </span><span class="org-comment">tree links</span>
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">first</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">last</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">next</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">prev</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">parent</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">hash links</span>
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">hash_next</span>;
  <span class="org-type">UI_Widget</span> *<span class="org-variable-name">hash_prev</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">key+generation info</span>
  <span class="org-type">UI_Key</span> <span class="org-variable-name">key</span>;
  <span class="org-type">U64</span> <span class="org-variable-name">last_frame_touched_index</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
};
</pre>
</div>

<p>
On every frame, the tree links section will be rewritten from scratch for the
entire hierarchy. The hash links are used to look up the persistent part of the
structure every frame.
</p>
</div>
</div>
<div id="outline-container-UI%20Keys%20or%20UI%20IDs" class="outline-3">
<h3 id="UI%20Keys%20or%20UI%20IDs"><a href="#UI%20Keys%20or%20UI%20IDs">UI Keys or UI IDs</a></h3>
<div class="outline-text-3" id="text-UI%20Keys%20or%20UI%20IDs">
<p>
A keying strategy needs to solve one problem: correlating one frame's call-site
with another frame's call-site.
</p>

<p>
This is not as trivial as it first may seem. Many people will initially try to
cleverly use source code coordinates (e.g. <code>__LINE__</code> and <code>__FILE__</code> in a C macro
expansion) as a way to generate keys. But that, then, raises the question of
what happens here:
</p>
<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">for</span>(<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; 100; i += 1)
{
    UI_Button(<span class="org-string">"I am a button!"</span>);
}
</pre>
</div>

<ul class="org-ul">
<li>Anything after a ## is hashed, but not displayed</li>
<li>If a ### occurs in the string, then only everything after it is hashed, and
only anything before it is displayed</li>
</ul>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">for</span>(<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; 100; i += 1)
{
    UI_Button(<span class="org-string">"I am a button!##%i"</span>, i);
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-Resources" class="outline-2">
<h2 id="Resources"><a href="#Resources">Resources</a></h2>
<div class="outline-text-2" id="text-Resources">
<ul class="org-ul">
<li><a href="https://ryanfleury.substack.com/p/ui-part-2-build-it-every-frame-immediate?s=r">Build it Every Frame</a></li>
<li><a href="https://ryanfleury.substack.com/p/ui-part-3-the-widget-building-language?s=r">The Widget Building Language</a></li>
<li><a href="https://rxi.github.io/microui_v2_an_implementation_overview.html">Microui v2: An Implementation Overview</a></li>
<li><a href="https://nakst.gitlab.io/tutorial/ui-part-1.html">UI Tutorial (by nakst)</a></li>
<li><a href="https://wassimulator.com/blog/programming/av-racer/devlog_6.html">AV-Racer Devlog (6): A Simple Function-Based Menu System</a></li>
</ul>
</div>
</div>
</main>
</body>
</html>
